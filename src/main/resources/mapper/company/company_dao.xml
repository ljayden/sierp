<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.company.company_dao">

    <select id="selectCompany" resultType="map">
    	SELECT * FROM company
    </select>
    
    <select id="selectCompanyBySeq" parameterType="map">
    	SELECT * FROM company WHERE company_seq = #{companySeq}
    </select>
    
	<select id="selectCompanyListCount" parameterType="map" resultType="int">
		SELECT 	count(*)
		FROM 	company c
		
		<where><include refid="companySearchCondition"/></where>
	</select>
	
	<select id="selectCompanyList" parameterType="map" resultType="com.sierp.web.domain.company.model.CompanySearch">
		SELECT  c.*
		FROM 	company c
		
	 	<where><include refid="companySearchCondition"/></where>
		LIMIT #{offset}, #{limit}
	</select>
	
    <sql id="companySearchCondition">
		c.customer_seq = #{customerSeq} AND c.company_seq <![CDATA[ <> ]]> #{ customerSeq }
		
		<if test="!@org.apache.commons.lang3.StringUtils@isEmpty(companyName)">
			AND c.company_name = #{companyName}
		</if>
		
		<if test="!@org.apache.commons.lang3.StringUtils@isEmpty(resisterManagerId)">
			AND c.resister_manager_id = #{resisterManagerId}
		</if>
		
		<if test="sido != null">
			AND c.sido = #{sido}
		</if>
		
		<if test="siGunGu != null">
			AND c.sigungu = #{siGunGu}
		</if>
    </sql>
    
    
    
        <!-- select id="select" parameterType="map" resultType=" ">
 
            <if test="brandCd != 'NONE'">
                AND al.  = #{ }
            </if> 
            
            			<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ey)">
				AND m. =#{ }
			</if>	
			
		  <![CDATA[>]]> 0 
					    <foreach collection="productCdList" item="productCd" open="(" separator="," close=")">
					    	#{productCd}
					    </foreach>
					    
		SELECT s.* FROM (
				SELECT 
						DATE_FORMAT( ymdt, '%Y%m%d%H%i%s') AS  , 
 
						(CASE @vsid WHEN sc._id THEN @rownum:=@ronum+1 ELSE @ronum:=1 END) rnum,
				         (@vsid:= sc._id) vsid  
				FROM 	stard sc
 
					INNER JOIN coupon c ON sp.coupon_id = c.coupon_id 
					, (SELECT @vsid:='', @rownum:=0 FROM DUAL) b
				WHERE
				 
				  AND 	sc.s_cd = 'NORMAL' 
			 ) s
		WHERE s.rnum = 1
    </select -->
    
</mapper>